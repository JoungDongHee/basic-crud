package com.crud.file.adapter;

import org.springframework.stereotype.Service;
import org.springframework.web.multipart.MultipartFile;

import java.util.List;

@Service
public class MalwareScannerManager {

    private final List<MalwareScannerAdapter> adapters;

    public MalwareScannerManager(List<MalwareScannerAdapter> malwareScannerAdapters) {
        this.adapters = malwareScannerAdapters;
    }

    public boolean scan(MultipartFile file, String contentType) {
        for (MalwareScannerAdapter adapter : adapters) {
            if (adapter.supports(contentType)) {
                return adapter.scanFile(file);
            }
        }
        throw new UnsupportedOperationException("지원하지 않는 파일 타입: " + contentType);
    }
}

